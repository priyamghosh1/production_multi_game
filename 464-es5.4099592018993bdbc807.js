!function(){"use strict";function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(!t)return;if("string"==typeof t)return e(t,r);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return e(t,r)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function o(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(self.webpackChunkaccounts=self.webpackChunkaccounts||[]).push([[464],{6464:function(e,a,n){n.r(a),n.d(a,{StockistReportModule:function(){return X}});var i,s=n(8583),c=n(3423),u=n(8259),d=n.n(u),l=n(2340),p=n(9925),m=n(7716),g=n(9765),h=n(205),f=n(5304),Z=n(8307),b=n(1841),R=n(4889),_=((i=function(){function e(t,a){r(this,e),this.http=t,this.errorService=a,this.BASE_API_URL=l.N.BASE_API_URL,this.barcodeReportRecords=[],this.barcodeReportSubject=new g.xQ,this.barcodeDetailsSubject=new g.xQ,this.customerSaleReportRecords=[],this.customerSaleReportSubject=new g.xQ,this.cardCustomerSaleReportRecords=[],this.cardCustomerSaleReportSubject=new g.xQ}return o(e,[{key:"getBarcodeReportRecords",value:function(){return t(this.barcodeReportRecords)}},{key:"getBarcodeReportListener",value:function(){return this.barcodeReportSubject.asObservable()}},{key:"getCustomerSaleReportRecords",value:function(){return t(this.customerSaleReportRecords)}},{key:"getCustomerSaleReportListener",value:function(){return this.customerSaleReportSubject.asObservable()}},{key:"getCardCustomerSaleReportListener",value:function(){return this.cardCustomerSaleReportSubject.asObservable()}},{key:"getBarcodeDetails",value:function(t){var e=this;return this.http.get(this.BASE_API_URL+"/cPanel/barcodeReport/particulars/"+t).pipe((0,f.K)(this.handleError),(0,Z.b)(function(t){e.barcodeDetails=t.data,e.barcodeDetailsSubject.next(Object.assign({},e.barcodeDetails))}))}},{key:"getBarcodeDetailsListener",value:function(){return this.barcodeDetailsSubject.asObservable()}},{key:"customerSaleReportByDate",value:function(e,r,a){var o=this;return this.http.post(this.BASE_API_URL+"/stockist/customerSaleReports",{startDate:e,endDate:r,userID:a}).pipe((0,f.K)(this.handleError),(0,Z.b)(function(e){e.data&&(o.customerSaleReportRecords=e.data,o.customerSaleReportSubject.next(t(o.customerSaleReportRecords)))}))}},{key:"cardCustomerSaleReportByDate",value:function(e,r,a){var o=this;return this.http.post(this.BASE_API_URL+"/stockist/cardCustomerSaleReports",{startDate:e,endDate:r,userID:a}).pipe((0,f.K)(this.handleError),(0,Z.b)(function(e){e.data&&(o.cardCustomerSaleReportRecords=e.data,o.cardCustomerSaleReportSubject.next(t(o.cardCustomerSaleReportRecords)))}))}},{key:"barcodeReportByDate",value:function(e,r,a){var o=this;return this.http.post(this.BASE_API_URL+"/stockist/barcodeReportByDate",{startDate:e,endDate:r,userID:a}).pipe((0,f.K)(this.handleError),(0,Z.b)(function(e){e.data&&(o.barcodeReportRecords=e.data,o.barcodeReportSubject.next(t(o.barcodeReportRecords)))}))}},{key:"serverError",value:function(t){return t instanceof Response?(0,h._)("backend server error"):(0,h._)(0===t.status?{status:t.status,message:"Backend Server is not Working",statusText:t.statusText}:401===t.status?{status:t.status,message:"Your are not authorised",statusText:t.statusText}:t)}},{key:"handleError",value:function(t){return t.error.message.includes("1062")?(0,h._)("Record already exists"):(0,h._)(t.error.message)}}]),e}()).\u0275fac=function(t){return new(t||i)(m.LFG(b.eN),m.LFG(R.T))},i.\u0275prov=m.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i),A=n(2088),v=n(1397),T=n(5939),q=n(8295),y=n(9983),S=n(3220),D=n(3679),k=n(1095),U=n(6640),x=n(7441),B=n(1494),C=n(2458);function M(t,e){if(1&t&&(m.TgZ(0,"tr"),m.TgZ(1,"td"),m._uU(2),m.qZA(),m.TgZ(3,"td"),m._uU(4),m.qZA(),m.TgZ(5,"td"),m._uU(6),m.qZA(),m.TgZ(7,"td"),m._uU(8),m.qZA(),m.TgZ(9,"td"),m._uU(10),m.qZA(),m.TgZ(11,"td"),m._uU(12),m.qZA(),m.qZA()),2&t){var r=e.$implicit;m.xp6(2),m.Oqu(r.terminal_pin),m.xp6(2),m.Oqu(r.stokiest_name),m.xp6(2),m.Oqu(r.total),m.xp6(2),m.Oqu(r.commission),m.xp6(2),m.Oqu(r.prize_value),m.xp6(2),m.Oqu(r.total-r.commission-r.prize_value)}}function w(t,e){1&t&&(m.TgZ(0,"div",34),m.TgZ(1,"h1"),m._uU(2,"No Data"),m.qZA(),m.qZA())}function J(t,e){if(1&t){var r=m.EpF();m.TgZ(0,"div"),m.TgZ(1,"table",30),m.NdJ("matSortChange",function(t){return m.CHM(r),m.oxw().sortData(t)}),m.TgZ(2,"thead"),m.TgZ(3,"tr"),m.TgZ(4,"th",22),m._uU(5,"Terminal Id"),m.qZA(),m.TgZ(6,"th",22),m._uU(7,"Stokiest Name"),m.qZA(),m.TgZ(8,"th",31),m._uU(9,"Total"),m.qZA(),m.TgZ(10,"th",32),m._uU(11,"Commission"),m.qZA(),m.TgZ(12,"th",26),m._uU(13,"Prize"),m.qZA(),m.TgZ(14,"th",33),m._uU(15,"NTP"),m.qZA(),m._UZ(16,"th"),m.qZA(),m.qZA(),m.TgZ(17,"tbody"),m.YNc(18,M,13,6,"tr",27),m.TgZ(19,"tr"),m._UZ(20,"td"),m.TgZ(21,"td"),m._uU(22,"Grand Total"),m.qZA(),m.TgZ(23,"td"),m._uU(24),m.qZA(),m._UZ(25,"td"),m._UZ(26,"td"),m._UZ(27,"td"),m.qZA(),m.qZA(),m.qZA(),m.YNc(28,w,3,0,"div",28),m.qZA()}if(2&t){var a=m.oxw();m.xp6(18),m.Q6J("ngForOf",a.customerSaleReportRecords),m.xp6(6),m.Oqu(a.totalAmount),m.xp6(4),m.Q6J("ngIf",0==a.customerSaleReportRecords.length)}}function O(t,e){if(1&t&&(m.TgZ(0,"mat-option",35),m._uU(1),m.qZA()),2&t){var r=e.$implicit;m.Q6J("value",r.id),m.xp6(1),m.hij(" ",r.game_name," ")}}function E(t,e){if(1&t&&(m.TgZ(0,"tr"),m.TgZ(1,"td"),m._uU(2),m.qZA(),m.TgZ(3,"td"),m._uU(4),m.qZA(),m.TgZ(5,"td"),m._uU(6),m.qZA(),m.TgZ(7,"td"),m._uU(8),m.qZA(),m.TgZ(9,"td"),m._uU(10),m.qZA(),m.TgZ(11,"td"),m._uU(12),m.qZA(),m.TgZ(13,"td"),m._uU(14),m.qZA(),m.TgZ(15,"td"),m._uU(16),m.qZA(),m.TgZ(17,"td"),m._uU(18),m.qZA(),m.TgZ(19,"td"),m.TgZ(20,"a",36),m._UZ(21,"i",37),m.qZA(),m.qZA(),m.qZA()),2&t){var r=e.$implicit;m.xp6(2),m.Oqu(r.barcode_number),m.xp6(2),m.Oqu(r.draw_time),m.xp6(2),m.Oqu(r.terminal_pin),m.xp6(2),m.Oqu("SINGLE DOUBLE TRIPLE"==r.game_name?"Triple chance":r.game_name),m.xp6(2),m.Oqu(r.ticket_taken_time),m.xp6(2),m.Oqu(r.total_quantity),m.xp6(2),m.Oqu(r.amount),m.xp6(2),m.Oqu(r.prize_value>0&&0==r.is_claimed?r.prize_value:"--"),m.xp6(2),m.Oqu(r.prize_value>0&&1==r.is_claimed?r.prize_value:"--")}}function I(t,e){1&t&&(m.TgZ(0,"div",34),m.TgZ(1,"h1"),m._uU(2,"No Data"),m.qZA(),m.qZA())}function F(t,e,r){return(t<e?-1:1)*(r?1:-1)}var N=[{path:"",component:function(){var t=function(){function t(e,a,o){r(this,t),this.stockistReportService=e,this.masterTerminalService=a,this.gameService=o,this.thisYear=(new Date).getFullYear(),this.thisMonth=(new Date).getMonth(),this.thisDay=(new Date).getDate(),this.startDate=new Date(this.thisYear,this.thisMonth,this.thisDay),this.isProduction=l.N.production,this.showDevArea=!1,this.barcodeReportRecords=[],this.customerSaleReportRecords=[],this.StartDateFilter=this.startDate,this.EndDateFilter=this.startDate,this.pipe=new s.uU("en-US"),this.totalAmount=0,this.columnNumber=4,this.selectedReport="0",this.terminals=[],this.copyBarcodeReportRecords=[],this.userData=JSON.parse(localStorage.getItem("user"))}return o(t,[{key:"ngOnInit",value:function(){var t=this;this.games=this.gameService.getGame(),this.gameService.getGameListener().subscribe(function(e){t.games=e,t.games.unshift({id:0,game_name:"All",auto_generate:"yes",active:"yes",multiplexer_random:"no",inforce:1,created_at:null,updated_at:null})}),this.games.unshift({id:0,game_name:"All",auto_generate:"yes",active:"yes",multiplexer_random:"no",inforce:1,created_at:null,updated_at:null}),this.terminals=this.masterTerminalService.getTerminals(),this.masterTerminalService.getTerminalListener().subscribe(function(e){t.terminals=e}),this.barcodeReportRecords=this.stockistReportService.getBarcodeReportRecords(),this.stockistReportService.getBarcodeReportListener().subscribe(function(e){t.barcodeReportRecords=e}),this.customerSaleReportRecords=this.stockistReportService.getCustomerSaleReportRecords(),this.stockistReportService.getCustomerSaleReportListener().subscribe(function(e){t.customerSaleReportRecords=e;var r=0;t.customerSaleReportRecords.forEach(function(t){r+=Number(t.total)}),t.totalAmount=r}),this.searchByDateTab1(),this.searchByDateTab2()}},{key:"sortByGame",value:function(){var t=this;0!==this.gameId&&null!=this.terminalPin?(this.barcodeReportRecords=this.copyBarcodeReportRecords.filter(function(e){return e.game_id===t.gameId}),this.barcodeReportRecords=this.barcodeReportRecords.filter(function(e){return e.terminal_pin===t.terminalPin})):this.barcodeReportRecords=0!==this.gameId?this.copyBarcodeReportRecords.filter(function(e){return e.game_id===t.gameId}):this.terminalPin?this.copyBarcodeReportRecords.filter(function(e){return e.terminal_pin===t.terminalPin}):this.copyBarcodeReportRecords}},{key:"sortByTerminal",value:function(t){var e=this;0!==this.gameId&&null!=this.terminalPin?(this.barcodeReportRecords=this.copyBarcodeReportRecords.filter(function(t){return t.game_id===e.gameId}),this.barcodeReportRecords=this.barcodeReportRecords.filter(function(t){return t.terminal_pin===e.terminalPin})):this.barcodeReportRecords=null!=t?this.copyBarcodeReportRecords.filter(function(e){return e.terminal_pin===t}):0!==this.gameId?this.copyBarcodeReportRecords.filter(function(t){return t.game_id===e.gameId}):this.copyBarcodeReportRecords}},{key:"searchByDateTab1",value:function(){d().fire({title:"Please Wait !",html:"loading ...",allowOutsideClick:!1,didOpen:function(){d().showLoading()}});var t=this.pipe.transform(this.StartDateFilter,"yyyy-MM-dd"),e=this.pipe.transform(this.EndDateFilter,"yyyy-MM-dd");this.stockistReportService.customerSaleReportByDate(t,e,this.userData.userId).subscribe(function(t){t.data&&d().close()})}},{key:"searchByDateTab2",value:function(){d().fire({title:"Please Wait !",html:"loading ...",allowOutsideClick:!1,didOpen:function(){d().showLoading()}});var t=this.pipe.transform(this.StartDateFilter,"yyyy-MM-dd"),e=this.pipe.transform(this.EndDateFilter,"yyyy-MM-dd");this.stockistReportService.barcodeReportByDate(t,e,this.userData.userId).subscribe(function(t){t.data&&d().close()})}},{key:"sortData",value:function(t){var e=this.barcodeReportRecords.slice();this.barcodeReportRecords=t.active&&""!==t.direction?e.sort(function(e,r){var a="asc"===t.direction;switch(t.active){case"barcode_number":return F(e.barcode_number,r.barcode_number,a);case"draw_time":return F(e.draw_time,r.draw_time,a);case"terminal_pin":return F(e.terminal_pin,r.terminal_pin,a);case"ticket_taken_time":return F(e.ticket_taken_time,r.ticket_taken_time,a);case"total_quantity":return F(e.total_quantity,r.total_quantity,a);case"amount":return F(e.amount,r.amount,a);default:return 0}}):e}},{key:"openPopup",value:function(t,e){var r=this;this.stockistReportService.getBarcodeDetails(t).subscribe(function(t){r.barcodeDetails=t.data})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(m.Y36(_),m.Y36(A.S),m.Y36(v.h))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-stockiest-report"]],viewQuery:function(t,e){var r;(1&t&&m.Gf(p.oB,5),2&t)&&(m.iGM(r=m.CRH())&&(e.modal=r.first))},decls:78,vars:23,consts:[[1,"mt-2","mr-3","ml-3"],["label","Customer sales report"],[1,"pt-1","d-flex"],[1,"col-3"],["appearance","fill"],["matInput","",3,"matDatepicker","ngModel","ngModelChange"],["matSuffix","",3,"for"],[3,"ngModel","ngModelChange"],["picker",""],["picker1",""],["mat-button","","color","accent",2,"font-size","20px",3,"click"],[4,"ngIf"],["label","Barcode report"],[1,"col"],[1,"text-center",2,"align-content","center","align-items","center","text-align","center"],[1,"row"],["bindLabel","pin","bindValue","pin",3,"items","ngModel","ngModelChange","change"],[3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["matSort","",1,"ml-4","col-11","table","table-bordered","table-sm",2,"border","none !important","height","50px","overflow","scroll",3,"matSortChange"],["mat-sort-header","barcode_number"],["mat-sort-header","draw_time"],["mat-sort-header","terminal_pin"],["mat-sort-header","ticket_taken_time"],["mat-sort-header","total_quantity"],["mat-sort-header","amount"],["mat-sort-header","prize_value"],[4,"ngFor","ngForOf"],["class","text-center",4,"ngIf"],["label","Draw wise report"],["matSort","",1,"table","table-bordered","table-sm",2,"border","none !important","height","50px","overflow","scroll",3,"matSortChange"],["mat-sort-header","total"],["mat-sort-header","commission"],["mat-sort-header","ntp"],[1,"text-center"],[3,"value"],["color","info","mdbWavesEffect","",1,"waves-effect","mb-4"],[1,"bi","bi-info-square-fill"]],template:function(t,e){if(1&t&&(m.TgZ(0,"mat-tab-group",0),m.TgZ(1,"mat-tab",1),m.TgZ(2,"div",2),m.TgZ(3,"div",3),m.TgZ(4,"mat-form-field",4),m.TgZ(5,"mat-label"),m._uU(6,"Start date"),m.qZA(),m.TgZ(7,"input",5),m.NdJ("ngModelChange",function(t){return e.StartDateFilter=t}),m.qZA(),m._UZ(8,"mat-datepicker-toggle",6),m.TgZ(9,"mat-datepicker",7,8),m.NdJ("ngModelChange",function(t){return e.StartDateFilter=t}),m.qZA(),m.qZA(),m.qZA(),m.TgZ(11,"div",3),m.TgZ(12,"mat-form-field",4),m.TgZ(13,"mat-label"),m._uU(14,"End date"),m.qZA(),m.TgZ(15,"input",5),m.NdJ("ngModelChange",function(t){return e.EndDateFilter=t}),m.qZA(),m._UZ(16,"mat-datepicker-toggle",6),m.TgZ(17,"mat-datepicker",7,9),m.NdJ("ngModelChange",function(t){return e.EndDateFilter=t}),m.qZA(),m.qZA(),m.qZA(),m.TgZ(19,"button",10),m.NdJ("click",function(){return e.searchByDateTab1()}),m._uU(20,"Search"),m.qZA(),m.qZA(),m.YNc(21,J,29,3,"div",11),m.qZA(),m.TgZ(22,"mat-tab",12),m.TgZ(23,"div",2),m.TgZ(24,"div",13),m.TgZ(25,"mat-form-field",4),m.TgZ(26,"mat-label"),m._uU(27,"Start date"),m.qZA(),m.TgZ(28,"input",5),m.NdJ("ngModelChange",function(t){return e.StartDateFilter=t}),m.qZA(),m._UZ(29,"mat-datepicker-toggle",6),m.TgZ(30,"mat-datepicker",7,8),m.NdJ("ngModelChange",function(t){return e.StartDateFilter=t}),m.qZA(),m.qZA(),m.qZA(),m.TgZ(32,"div",13),m.TgZ(33,"mat-form-field",4),m.TgZ(34,"mat-label"),m._uU(35,"End date"),m.qZA(),m.TgZ(36,"input",5),m.NdJ("ngModelChange",function(t){return e.EndDateFilter=t}),m.qZA(),m._UZ(37,"mat-datepicker-toggle",6),m.TgZ(38,"mat-datepicker",7,9),m.NdJ("ngModelChange",function(t){return e.EndDateFilter=t}),m.qZA(),m.qZA(),m.qZA(),m.TgZ(40,"button",10),m.NdJ("click",function(){return e.searchByDateTab2()}),m._uU(41,"Search"),m.qZA(),m.qZA(),m.TgZ(42,"div",14),m.TgZ(43,"div",15),m.TgZ(44,"div",3),m.TgZ(45,"ng-select",16),m.NdJ("ngModelChange",function(t){return e.terminalPin=t})("change",function(){return e.sortByTerminal(e.terminalPin)}),m.qZA(),m.qZA(),m.TgZ(46,"div",3),m.TgZ(47,"mat-form-field",4),m.TgZ(48,"mat-label"),m._uU(49,"Games"),m.qZA(),m.TgZ(50,"mat-select",17),m.NdJ("ngModelChange",function(t){return e.gameId=t})("selectionChange",function(){return e.sortByGame()}),m.YNc(51,O,2,2,"mat-option",18),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(52,"table",19),m.NdJ("matSortChange",function(t){return e.sortData(t)}),m.TgZ(53,"thead"),m.TgZ(54,"tr"),m.TgZ(55,"th",20),m._uU(56,"Barcode"),m.qZA(),m.TgZ(57,"th",21),m._uU(58,"Draw time"),m.qZA(),m.TgZ(59,"th",22),m._uU(60,"Terminal"),m.qZA(),m.TgZ(61,"th",22),m._uU(62,"Game"),m.qZA(),m.TgZ(63,"th",23),m._uU(64,"Ticket take time"),m.qZA(),m.TgZ(65,"th",24),m._uU(66,"Quantity"),m.qZA(),m.TgZ(67,"th",25),m._uU(68,"Amount"),m.qZA(),m.TgZ(69,"th",26),m._uU(70,"UnClaimed Amount"),m.qZA(),m.TgZ(71,"th",26),m._uU(72,"Claimed Amount"),m.qZA(),m._UZ(73,"th"),m.qZA(),m.qZA(),m.TgZ(74,"tbody"),m.YNc(75,E,22,9,"tr",27),m.qZA(),m.qZA(),m.YNc(76,I,3,0,"div",28),m.qZA(),m.qZA(),m._UZ(77,"mat-tab",29),m.qZA()),2&t){var r=m.MAs(10),a=m.MAs(18);m.xp6(7),m.Q6J("matDatepicker",r)("ngModel",e.StartDateFilter),m.xp6(1),m.Q6J("for",r),m.xp6(1),m.Q6J("ngModel",e.StartDateFilter),m.xp6(6),m.Q6J("matDatepicker",a)("ngModel",e.EndDateFilter),m.xp6(1),m.Q6J("for",a),m.xp6(1),m.Q6J("ngModel",e.EndDateFilter),m.xp6(4),m.Q6J("ngIf","0"==e.selectedReport),m.xp6(7),m.Q6J("matDatepicker",r)("ngModel",e.StartDateFilter),m.xp6(1),m.Q6J("for",r),m.xp6(1),m.Q6J("ngModel",e.StartDateFilter),m.xp6(6),m.Q6J("matDatepicker",a)("ngModel",e.EndDateFilter),m.xp6(1),m.Q6J("for",a),m.xp6(1),m.Q6J("ngModel",e.EndDateFilter),m.xp6(7),m.Q6J("items",e.terminals)("ngModel",e.terminalPin),m.xp6(5),m.Q6J("ngModel",e.gameId),m.xp6(1),m.Q6J("ngForOf",e.games),m.xp6(24),m.Q6J("ngForOf",e.barcodeReportRecords),m.xp6(1),m.Q6J("ngIf",0==e.barcodeReportRecords.length)}},directives:[T.SP,T.uX,q.KE,q.hX,y.Nt,S.hl,D.Fj,D.JJ,D.On,S.nW,q.R9,S.Mq,k.lW,s.O5,U.w9,x.gD,s.sg,B.YE,B.nU,C.ey,p.b6],styles:[""]}),t}()}],Q=function(){var t=o(function t(){r(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.oAB({type:t}),t.\u0275inj=m.cJS({imports:[[c.Bz.forChild(N)],c.Bz]}),t}(),P=n(5566),L=n(5480),j=n(3738),Y=n(5396),z=n(9870),G=n(4820),W=n(2542),K=n(346),X=function(){var t=o(function t(){r(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.oAB({type:t}),t.\u0275inj=m.cJS({imports:[[s.ez,Q,T.Nh,L.q,P.o9,x.LD,j.QW,D.u5,D.UX,Y.rP,B.JX,z.aE,z.bz,p.At,G.UU,K.g,S.FA,y.c,D.u5,C.XK,C.si,k.ot,W.vV,q.lN,U.A0]]}),t}()}}])}();